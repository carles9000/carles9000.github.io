<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:"Segoe UI Emoji";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	font-size:8.0pt;
	font-family:"Tahoma",sans-serif;
	letter-spacing:.2pt;}
p.MsoNoSpacing, li.MsoNoSpacing, div.MsoNoSpacing
	{margin:0cm;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
.MsoChpDefault
	{font-size:10.0pt;
	font-family:"Calibri",sans-serif;}
@page WordSection1
	{size:595.3pt 841.9pt;
	margin:70.85pt 3.0cm 70.85pt 3.0cm;}
div.WordSection1
	{page:WordSection1;}
-->
</style>

</head>

<body lang=ES style='word-wrap:break-word'>

<div class=WordSection1>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse'>
 <tr style='height:2.0cm'>
  <td width=415 style='width:311.6pt;border:none;border-bottom:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:2.0cm'>
  <table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=434
   style='width:325.6pt;border-collapse:collapse'>
   <tr>
    <td width=370 style='width:277.5pt;padding:0cm 5.4pt 0cm 5.4pt'>
    <p class=MsoNormal style='text-align:justify;line-height:105%'><b><span
    style='font-size:22.0pt;line-height:105%'>Ticket Project (I)</span></b></p>
    </td>
    <td width=64 style='width:48.1pt;padding:0cm 5.4pt 0cm 5.4pt'>
    <p class=MsoNormal style='text-align:justify;line-height:105%'><b><span
    style='font-size:18.0pt;line-height:105%'>&nbsp;</span></b></p>
    </td>
   </tr>
  </table>
  </td>
  <td width=151 style='width:113.1pt;border:none;border-bottom:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:2.0cm'>
  <p class=MsoNormal align=right style='text-align:right;line-height:105%'><b><span
  style='font-size:18.0pt;line-height:105%'><img width=84 height=51
  src="../../es/htm/que_es_ut_archivos/image001.png"></span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
display:none;letter-spacing:0pt'>&nbsp;</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="99%"
 style='width:99.48%;border-collapse:collapse'>
 <tr style='height:13.7pt'>
  <td width=416 style='width:11.0cm;padding:.7pt 4.3pt .7pt 0cm;height:13.7pt'>
  <p class=MsoNormal align=right style='text-align:right;line-height:105%'><span
  style='font-size:16.0pt;line-height:105%'>&nbsp;</span></p>
  </td>
  <td width=148 style='width:111.15pt;padding:.7pt 4.3pt .7pt 0cm;height:13.7pt'>
  <p class=MsoNormal align=right style='text-align:right;line-height:105%'>Autor:
  Carles Aubia</p>
  <p class=MsoNormal align=right style='text-align:right;line-height:105%'>Fecha
  Rev: 14/11/2025</p>
  </td>
 </tr>
</table>

<p class=MsoNoSpacing align=center style='text-align:center'><b><span
style='font-size:14.0pt'>&nbsp;</span></b></p>

<p class=MsoNoSpacing>&nbsp;</p>

<p class=MsoNoSpacing style='text-align:justify'><span style='font-size:14.0pt'>Let's
whip up a little app for the kids in town. All they gotta do is enter their
name and the system will log it and give them a code to access the movie - easy
peasy.</span></p>

<p class=MsoNoSpacing><span style='font-size:14.0pt'>&nbsp;</span></p>

<p class=MsoNoSpacing><span style='font-size:14.0pt'>We'll create a file called
ticket.html</span></p>

<p class=MsoNoSpacing>&nbsp;</p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;border:none'>
 <tr>
  <td width="100%" valign=top style='width:100.0%;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>&lt;!DOCTYPE
  html&gt;</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>&lt;html&gt;</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>&lt;body&gt;</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>&nbsp;</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'> 
  &lt;h2&gt;Movie Ticket&lt;/h2&gt;</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>&nbsp;</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>  &lt;form
  action=&quot;<b><span style='color:#EE0000'>proc_ticket.prg</span></b>&quot;
  method='<b><span style='color:#538135'>post</span></b>' &gt;</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>    &lt;label
  for=&quot;fname&quot;&gt;Name:&lt;/label&gt;&lt;br&gt;</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>    &lt;input
  type=&quot;text&quot; name=&quot;user_name&quot;
  value=&quot;John&quot;&gt;&lt;br&gt;&lt;br&gt;</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>    &lt;input
  type=&quot;submit&quot; value=&quot;Give me a ticket&quot;&gt;</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>  &lt;/form&gt;
  </span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>&nbsp;</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>  &lt;p&gt;If
  you click the &quot;Submit&quot; button, the form-data will be sent to a page
  called &quot;proc_ticket.prg&quot;.&lt;/p&gt;</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>&nbsp;</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>&lt;/body&gt;</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>&lt;/html&gt;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNoSpacing>&nbsp;</p>

<p class=MsoNoSpacing>&nbsp;</p>

<p class=MsoNoSpacing><span style='font-size:14.0pt'>We'll create the ticket
request process, and we'll call it&nbsp;<b><span style='color:#EE0000'>proc_ticket.prg</span></b><span
style='color:#EE0000'> </span></span></p>

<p class=MsoNoSpacing>&nbsp;</p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;border:none'>
 <tr>
  <td width=566 valign=top style='width:424.7pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>#define
  FILE_TICKET   hb_dirbase() + 'ticket.dbf'</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>#define
  MAX_TIMEOUT  5</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>&nbsp;</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>function main()</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>&nbsp;</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>     local
  lExist    := file( FILE_TICKET )</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>     local
  hData     := <b><span style='color:#538135'>UPost()</span></b></span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>     local
  cAlias, aDbf, cMessage          </span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>     </span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>     if ! file(
  FILE_TICKET )</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>     </span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>          aDbf   
  := {}</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>          AAdd(aDbf,
  { 'name', 'C', 40, 0 })</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>          AAdd(aDbf,
  { 'data', 'D',  8, 0 })         </span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>          AAdd(aDbf,
  { 'key' , 'C',  5, 0 })         </span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>          </span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>          dbCreate(
  FILE_TICKET, aDbf )</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>&nbsp;</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>     endif</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>&nbsp;</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>     USE (
  FILE_TICKET ) SHARED NEW </span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>     </span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>     cAlias :=
  alias() </span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>&nbsp;</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>     (cAlias)-&gt;(
  Dbappend() )   </span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>&nbsp;</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>     if
  (cAlias)-&gt;( TRlock() ) </span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>&nbsp;</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>          (cAlias)-&gt;name
   := hData[  'user_name' ]</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>          (cAlias)-&gt;data
   := date()</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>          (cAlias)-&gt;key
    := key()</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>&nbsp;</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>          (cAlias)-&gt;(
  DbUnlock() )</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>&nbsp;</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>     endif           </span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>     </span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>   
  (cAlias)-&gt;( DbCommit() ) </span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>     </span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>     cMessage
  := '&lt;html&gt;'</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>     cMessage
  += '&lt;h1&gt;Request processed !&lt;/h1&gt;&lt;hr&gt;'</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>     cMessage
  += '&lt;h3&gt;Hi ' + hData[ 'user_name' ] + '. Your access code is ' +
  (cAlias)-&gt;key + '&lt;/h3&gt;'</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>     cMessage
  += '&lt;hr&gt;&lt;small&gt;' + 'This ticket was processed at ' + dtoc( date()
  ) + ' ' + time() + '&lt;/small&gt;'</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>     cMessage
  += '&lt;/html&gt;'</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'> </span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>   
  (cAlias)-&gt;( DbCloseArea() ) </span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>&nbsp;</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'> RETU cMessage</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>     </span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>//---------------------------------------------------//
  </span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>&nbsp;</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>function
  TRLock()</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>    </span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>    LOCAL
  lRlock     := .F.</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>    LOCAL nIni 
   := Seconds()</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>    LOCAL
  cAlias     := Alias()</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>    LOCAL
  nElapsed</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>    </span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>    WHILE
  !lRlock</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>     </span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>          lRlock
  := (cAlias)-&gt;(DbRlock())</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>        </span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>        if
  !lRlock</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>           
  nElapsed := Seconds() - nIni</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>            if
  nElapsed &gt;= MAX_TIMEOUT</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>               
  EXIT  // Timeout</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>           
  endif</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>           
  hb_IdleSleep(0.001)  </span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>        endif</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>          </span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>    END</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>    </span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>RETU lRlock     </span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>&nbsp;</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>//---------------------------------------------------//
  </span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>&nbsp;</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>FUNCTION Key()</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>&nbsp;</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>    LOCAL cKey   :=
  ''</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>    LOCAL
  cWords := 'abcdefghijklmnopqrstuvwxyz'</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>    LOCAL nI,
  nPos</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>    </span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>    FOR nI := 1
  TO 5</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>        nPos :=
  hb_RandomInt(1, Len(cWords))</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>        cKey +=
  SubStr(cWords, nPos, 1)</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>    NEXT</span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>    </span></p>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>RETURN cKey</span></p>
  </td>
 </tr>
</table>

<p class=MsoNoSpacing>&nbsp;</p>

<p class=MsoNoSpacing style='text-align:justify'><span style='font-size:14.0pt'>This
is some super basic code that handles everything in a simple way - it even
creates the table! Obviously it can be improved a ton: indexes, maximum
requests, number of tickets, capacity limits... but I'll leave that for all of
you to figure out </span><span style='font-size:14.0pt;font-family:"Segoe UI Emoji",sans-serif'>&#128522;</span></p>

<p class=MsoNoSpacing style='text-align:justify'><span style='font-size:14.0pt'>&nbsp;</span></p>

<p class=MsoNoSpacing style='text-align:justify'><span style='font-size:14.0pt'>We
fire up hix &#8594; type 'start' and run localhost/ticket.html and voilà, our
app is good to go!</span></p>

<p class=MsoNoSpacing>&nbsp;</p>

<p class=MsoNoSpacing><img width=567 height=206 id="Imagen 5"
src="ticket_v1_en_archivos/image004.jpg"></p>

<p class=MsoNoSpacing>&nbsp;</p>

<p class=MsoNoSpacing><img width=567 height=206 id="Imagen 6"
src="ticket_v1_en_archivos/image005.jpg"></p>

<p class=MsoNoSpacing><span style='font-size:14.0pt'>All the data will be in
our table.</span></p>

<p class=MsoNoSpacing>&nbsp;</p>

<p class=MsoNoSpacing>&nbsp;</p>

<p class=MsoNoSpacing><img width=233 height=178 id="Imagen 1"
src="ticket_v1_en_archivos/image003.png"></p>

<p class=MsoNoSpacing>&nbsp;</p>

<p class=MsoNoSpacing>&nbsp;</p>

</div>

</body>

</html>
